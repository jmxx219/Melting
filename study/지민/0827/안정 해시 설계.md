## 안정 해시 설계

- 해시 키 재배치 문제
    - N개의 캐시 서버에 부하를 균하게 나누는 보편적인 방법은 해시 함수를 사용하는 것
    - 특정한 키가 보관된 서버를 알기 위해 나머지 연산을 적용하는데, 이 방법은 서버 풀의 크기가 고정되어 있을 때 잘 작동함
    - 서버가 추가되거나 기존 서버가 삭제되면 문제 발생(대규모 캐시 미스가 발생함)
    - 이를 해결하기 위한 기술이 안정 해시
- 안정 해시
    - 해시 테이블 크기가 조정될 때 평균적으로 오직 k/n개의 키만 재배치하는 해시 기술
        - k: 키의 개수, n: 슬롯 개수
    - 해시의 출력 값 범위: 0 ~ 2^160 -1
    - 해시 공간의 양쪽을 구부려 접으면 해시 링이 만들어지고, 해시 함수 f를 사용하여 서버를 해시 링 위의 어떤 위치에 대응시킬 수 있다.
        - 한 키가 저장되는 서버는 해당 키의 위치로부터 시계 방향으로 링을 탐색해나가면서 만나는 첫 번째 서버
        - 서버를 추가/삭제하더라도 키 가운데 일부만 재배치되고, 나머지 키에는 영향이 없다.
- 기본 구현법의 두 가지 문제
    - 서버와 키를 균등 분포 해시 함수를 사용해 해시 링에 배치하고, 키의 위치에서 링을 시계 방향으로 탐색하다 만나는 최초의 서버가 키가 저장될 서버이다.
    - 서버가 추가/삭제 되는 경우, 파티션의 크기를 균등하게 유지하는게 불가능하다는 문제 존재
        - 파티션: 인접한 서버 사이의 해시 공간